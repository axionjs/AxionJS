{
  "$schema": "http://localhost:3001/schema/registry-item.json",
  "name": "accessibility",
  "type": "registry:ui",
  "author": "axionjs (https://www.axionjs.com)",
  "dependencies": [
    "zustand"
  ],
  "registryDependencies": [
    "dialog",
    "switch",
    "button",
    "avatar",
    "tabs",
    "tooltip",
    "slider"
  ],
  "files": [
    {
      "path": "ui/accessibility/components/AccessibilityUI.tsx",
      "content": "\"use client\";\r\n\r\nimport React, { useEffect } from \"react\";\r\nimport {\r\n  useAccessibilityStore,\r\n  FeatureIntensity,\r\n  ContrastMode,\r\n} from \"@/registry/default/ui/accessibility/lib/accessibility-store\";\r\nimport screenReaderService from \"@/registry/default/ui/accessibility/lib/screen-reader-service\";\r\n\r\nimport { Button } from \"@/registry/default/ui/button\";\r\nimport { Switch } from \"@/registry/default/ui/switch\";\r\nimport { Slider } from \"@/registry/default/ui/slider\";\r\nimport {\r\n  Tabs,\r\n  TabsContent,\r\n  TabsList,\r\n  TabsTrigger,\r\n} from \"@/registry/default/ui/tabs\";\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/registry/default/ui/tooltip\";\r\n\r\nimport {\r\n  LucideEye,\r\n  LucideMaximize,\r\n  LucideText,\r\n  LucideUnderline,\r\n  LucideVolume2,\r\n  LucideRefreshCw,\r\n  LucideX,\r\n  LucideLineChart,\r\n  LucideInfo,\r\n  LucidePalette,\r\n  LucideMousePointer2,\r\n  LucideBookText,\r\n  LucideHand,\r\n  LucideZap,\r\n  LucidePersonStanding,\r\n} from \"lucide-react\";\r\n\r\n// Inlined AccessibilitySlider component\r\ninterface AccessibilitySliderProps {\r\n  value: FeatureIntensity | ContrastMode;\r\n  onChange: (value: FeatureIntensity | ContrastMode) => void;\r\n  label: string;\r\n  icon: React.ReactNode;\r\n  options?: { value: string; label: string }[];\r\n}\r\n\r\nfunction AccessibilitySlider({\r\n  value,\r\n  onChange,\r\n  label,\r\n  icon,\r\n  options,\r\n}: AccessibilitySliderProps) {\r\n  const defaultOptions = [\r\n    { value: \"default\", label: \"Default\" },\r\n    { value: \"medium\", label: \"Medium\" },\r\n    { value: \"high\", label: \"High\" },\r\n  ];\r\n\r\n  const currentOptions = options || defaultOptions;\r\n\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      <div className=\"flex items-center gap-2\">\r\n        <div className=\"w-5 h-5 flex items-center justify-center\">{icon}</div>\r\n        <span className=\"text-sm font-medium\">{label}</span>\r\n      </div>\r\n      <Tabs\r\n        value={value}\r\n        onValueChange={(v) => onChange(v as FeatureIntensity | ContrastMode)}\r\n        className=\"w-full\"\r\n      >\r\n        <TabsList\r\n          className={`grid w-full gap-2`}\r\n          style={{\r\n            gridTemplateColumns: `repeat(${currentOptions.length}, 1fr)`,\r\n          }}\r\n        >\r\n          {currentOptions.map((option) => (\r\n            <TabsTrigger\r\n              key={option.value}\r\n              value={option.value}\r\n              className=\"text-xs\"\r\n            >\r\n              {option.label}\r\n            </TabsTrigger>\r\n          ))}\r\n        </TabsList>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Combined AccessibilityUI component\r\nexport function AccessibilityUI({ children }: { children: React.ReactNode }) {\r\n  const {\r\n    isOpen,\r\n    toggleOpen,\r\n    contrast,\r\n    setContrast,\r\n    highlightLinks,\r\n    setHighlightLinks,\r\n    textSize,\r\n    setTextSize,\r\n    textSpacing,\r\n    setTextSpacing,\r\n    hideImages,\r\n    toggleHideImages,\r\n    dyslexiaFriendly,\r\n    toggleDyslexiaFriendly,\r\n    lineHeight,\r\n    setLineHeight,\r\n    saturation,\r\n    setSaturation,\r\n    cursorSize,\r\n    setCursorSize,\r\n    screenReader,\r\n    toggleScreenReader,\r\n    setScreenReaderSpeed,\r\n    setScreenReaderVolume,\r\n    resetAll,\r\n  } = useAccessibilityStore();\r\n\r\n  // Initialize and clean up screen reader service\r\n  useEffect(() => {\r\n    screenReaderService.initialize(\r\n      screenReader.enabled,\r\n      screenReader.speed,\r\n      screenReader.volume,\r\n    );\r\n    return () => {\r\n      screenReaderService.cleanup();\r\n    };\r\n  }, [screenReader.enabled, screenReader.speed, screenReader.volume]);\r\n\r\n  // Apply all accessibility settings to the HTML element (moved from AccessibilityProvider)\r\n  useEffect(() => {\r\n    const html = document.documentElement;\r\n\r\n    const classesToRemove = [\r\n      \"contrast-medium\",\r\n      \"contrast-high\",\r\n      \"contrast-windows-inverted\",\r\n      \"contrast-windows-dark\",\r\n      \"contrast-windows-light\",\r\n      \"highlight-links-medium\",\r\n      \"highlight-links-high\",\r\n      \"text-size-medium\",\r\n      \"text-size-high\",\r\n      \"text-spacing-medium\",\r\n      \"text-spacing-high\",\r\n      \"hide-images\",\r\n      \"dyslexia-friendly\",\r\n      \"line-height-medium\",\r\n      \"line-height-high\",\r\n      \"saturation-medium\",\r\n      \"saturation-high\",\r\n      \"cursor-medium\",\r\n      \"cursor-high\",\r\n    ];\r\n\r\n    html.classList.remove(...classesToRemove);\r\n\r\n    if (contrast === \"medium\") {\r\n      html.classList.add(\"contrast-medium\");\r\n    } else if (contrast === \"high\") {\r\n      html.classList.add(\"contrast-high\");\r\n    } else if (contrast === \"inverted\") {\r\n      html.classList.add(\"contrast-windows-inverted\");\r\n    } else if (contrast === \"dark\") {\r\n      html.classList.add(\"contrast-windows-dark\");\r\n    } else if (contrast === \"light\") {\r\n      html.classList.add(\"contrast-windows-light\");\r\n    }\r\n\r\n    if (highlightLinks === \"medium\") {\r\n      html.classList.add(\"highlight-links-medium\");\r\n    } else if (highlightLinks === \"high\") {\r\n      html.classList.add(\"highlight-links-high\");\r\n    }\r\n\r\n    if (textSize === \"medium\") {\r\n      html.classList.add(\"text-size-medium\");\r\n    } else if (textSize === \"high\") {\r\n      html.classList.add(\"text-size-high\");\r\n    }\r\n\r\n    if (textSpacing === \"medium\") {\r\n      html.classList.add(\"text-spacing-medium\");\r\n    } else if (textSpacing === \"high\") {\r\n      html.classList.add(\"text-spacing-high\");\r\n    }\r\n\r\n    if (hideImages) {\r\n      html.classList.add(\"hide-images\");\r\n    }\r\n\r\n    if (dyslexiaFriendly) {\r\n      html.classList.add(\"dyslexia-friendly\");\r\n    }\r\n\r\n    if (lineHeight === \"medium\") {\r\n      html.classList.add(\"line-height-medium\");\r\n    } else if (lineHeight === \"high\") {\r\n      html.classList.add(\"line-height-high\");\r\n    }\r\n\r\n    if (saturation === \"medium\") {\r\n      html.classList.add(\"saturation-medium\");\r\n    } else if (saturation === \"high\") {\r\n      html.classList.add(\"saturation-high\");\r\n    }\r\n\r\n    if (cursorSize === \"medium\") {\r\n      html.classList.add(\"cursor-medium\");\r\n    } else if (cursorSize === \"high\") {\r\n      html.classList.add(\"cursor-high\");\r\n    }\r\n\r\n    if (screenReader.enabled) {\r\n      html.setAttribute(\"data-screen-reader\", \"enabled\");\r\n    } else {\r\n      html.removeAttribute(\"data-screen-reader\");\r\n    }\r\n  }, [\r\n    contrast,\r\n    highlightLinks,\r\n    textSize,\r\n    textSpacing,\r\n    hideImages,\r\n    dyslexiaFriendly,\r\n    lineHeight,\r\n    saturation,\r\n    cursorSize,\r\n    screenReader,\r\n  ]);\r\n\r\n  // Event listener for the custom toggle event (for the floating button AND keyboard shortcut)\r\n  // This listener now also handles the Ctrl+U keyboard shortcut (moved from AccessibilityProvider)\r\n  useEffect(() => {\r\n    const handleToggleEvent = () => {\r\n      toggleOpen();\r\n    };\r\n\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      if ((event.ctrlKey || event.metaKey) && event.key.toLowerCase() === \"u\") {\r\n        event.preventDefault();\r\n        toggleOpen(); // Directly toggle the state\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"toggleAccessibilityPanel\", handleToggleEvent);\r\n    document.addEventListener(\"keydown\", handleKeyDown); // Listen for keyboard shortcut\r\n\r\n    return () => {\r\n      document.removeEventListener(\r\n        \"toggleAccessibilityPanel\",\r\n        handleToggleEvent,\r\n      );\r\n      document.removeEventListener(\"keydown\", handleKeyDown); // Clean up keyboard listener\r\n    };\r\n  }, [toggleOpen]);\r\n\r\n  const contrastOptions = [\r\n    { value: \"default\", label: \"Default\" },\r\n    { value: \"inverted\", label: \"Inverted\" },\r\n    { value: \"dark\", label: \"Dark\" },\r\n    { value: \"light\", label: \"Light\" },\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      {children}\r\n\r\n      {/* Accessibility Trigger (Floating Button) */}\r\n      <TooltipProvider>\r\n        <Tooltip>\r\n          <TooltipTrigger asChild>\r\n            <Button\r\n              variant=\"default\"\r\n              size=\"lg\"\r\n              className=\"fixed bottom-4 right-4 z-[9998] rounded-full w-16 h-16 shadow-lg bg-primary hover:bg-primary/85 flex items-center justify-center accessibility-trigger\"\r\n              aria-label=\"Open Accessibility Menu\"\r\n              onClick={toggleOpen}\r\n            >\r\n              <div className=\"relative\">\r\n                <LucidePersonStanding className=\"w-6 h-6 text-secondary\" />\r\n                {screenReader.enabled && (\r\n                  <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full border border-white dark:border animate-pulse\" />\r\n                )}\r\n              </div>\r\n            </Button>\r\n          </TooltipTrigger>\r\n          <TooltipContent side=\"left\">\r\n            <p>Accessibility Menu</p>\r\n          </TooltipContent>\r\n        </Tooltip>\r\n      </TooltipProvider>\r\n\r\n      {/* Overlay */}\r\n      {isOpen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/50 z-[9997] transition-opacity duration-300\"\r\n          onClick={toggleOpen}\r\n          aria-hidden=\"true\"\r\n        />\r\n      )}\r\n\r\n      {/* Accessibility Sidebar */}\r\n      <div\r\n        className={`fixed top-0 right-0 h-full bg-background text-foreground shadow-xl z-[9999] transition-transform duration-300 ease-in-out border-l\r\n          ${isOpen ? \"translate-x-0\" : \"translate-x-full\"}\r\n          w-full sm:w-[35vw] md:w-[30vw] lg:w-[25vw] min-w-[350px] max-w-[450px]\r\n        `}\r\n        aria-label=\"Accessibility Settings\"\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n      >\r\n        {/* Header */}\r\n        <div className=\"p-4 border-b flex items-center justify-between bg-background flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold text-foreground\">\r\n            Accessibility Settings\r\n          </h2>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            aria-label=\"Close Accessibility Menu\"\r\n            className=\"text-muted-foreground hover:text-foreground\"\r\n            onClick={toggleOpen}\r\n          >\r\n            <LucideX className=\"h-5 w-5\" />\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex flex-col h-[calc(100vh-140px)] overflow-hidden\">\r\n          <Tabs\r\n            defaultValue=\"vision\"\r\n            className=\"p-4 flex-grow flex flex-col overflow-hidden\"\r\n          >\r\n            <TabsList className=\"grid grid-cols-4 w-full mb-4 flex-shrink-0\">\r\n              <TabsTrigger value=\"vision\" className=\"text-xs\">\r\n                <LucideEye className=\"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2\" />\r\n                <span className=\"hidden sm:inline\">Vision</span>\r\n                <span className=\"sm:hidden\">V</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"content\" className=\"text-xs\">\r\n                <LucideBookText className=\"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2\" />\r\n                <span className=\"hidden sm:inline\">Content</span>\r\n                <span className=\"sm:hidden\">C</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"interaction\" className=\"text-xs\">\r\n                <LucideHand className=\"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2\" />\r\n                <span className=\"hidden sm:inline\">Interaction</span>\r\n                <span className=\"sm:hidden\">I</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"screen-reader\" className=\"text-xs\">\r\n                <LucideVolume2 className=\"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2\" />\r\n                <span className=\"hidden sm:inline\">Reader</span>\r\n                <span className=\"sm:hidden\">R</span>\r\n              </TabsTrigger>\r\n            </TabsList>\r\n\r\n            <div className=\"overflow-y-auto flex-grow pr-2 pb-2\">\r\n              <TabsContent value=\"vision\" className=\"space-y-6\">\r\n                <AccessibilitySlider\r\n                  label=\"Contrast\"\r\n                  value={contrast}\r\n                  onChange={setContrast}\r\n                  icon={<LucidePalette className=\"h-4 w-4\" />}\r\n                  options={contrastOptions}\r\n                />\r\n\r\n                <AccessibilitySlider\r\n                  label=\"Highlight Links\"\r\n                  value={highlightLinks}\r\n                  onChange={setHighlightLinks}\r\n                  icon={<LucideUnderline className=\"h-4 w-4\" />}\r\n                />\r\n\r\n                <AccessibilitySlider\r\n                  label=\"Saturation\"\r\n                  value={saturation}\r\n                  onChange={setSaturation}\r\n                  icon={<LucideLineChart className=\"h-4 w-4\" />}\r\n                />\r\n\r\n                <div className=\"flex items-center justify-between rounded-lg border p-4\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <label\r\n                      htmlFor=\"hide-images\"\r\n                      className=\"text-sm font-medium\"\r\n                    >\r\n                      Hide Images\r\n                    </label>\r\n                    <p className=\"text-muted-foreground text-sm\">\r\n                      Removes all images from the page.\r\n                    </p>\r\n                  </div>\r\n                  <Switch\r\n                    id=\"hide-images\"\r\n                    checked={hideImages}\r\n                    onCheckedChange={toggleHideImages}\r\n                  />\r\n                </div>\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"content\" className=\"space-y-6\">\r\n                <AccessibilitySlider\r\n                  label=\"Text Size\"\r\n                  value={textSize}\r\n                  onChange={setTextSize}\r\n                  icon={<LucideText className=\"h-4 w-4\" />}\r\n                />\r\n\r\n                <AccessibilitySlider\r\n                  label=\"Text Spacing\"\r\n                  value={textSpacing}\r\n                  onChange={setTextSpacing}\r\n                  icon={<LucideMaximize className=\"h-4 w-4\" />}\r\n                />\r\n\r\n                <AccessibilitySlider\r\n                  label=\"Line Height\"\r\n                  value={lineHeight}\r\n                  onChange={setLineHeight}\r\n                  icon={<LucideLineChart className=\"h-4 w-4 rotate-90\" />}\r\n                />\r\n\r\n                <div className=\"flex items-center justify-between rounded-lg border p-4\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <label\r\n                      htmlFor=\"dyslexia-friendly\"\r\n                      className=\"text-sm font-medium\"\r\n                    >\r\n                      Dyslexia Friendly Font\r\n                    </label>\r\n                    <p className=\"text-muted-foreground text-sm\">\r\n                      Changes text to a font optimized for dyslexia.\r\n                    </p>\r\n                  </div>\r\n                  <Switch\r\n                    id=\"dyslexia-friendly\"\r\n                    checked={dyslexiaFriendly}\r\n                    onCheckedChange={toggleDyslexiaFriendly}\r\n                  />\r\n                </div>\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"interaction\" className=\"space-y-6\">\r\n                <AccessibilitySlider\r\n                  label=\"Cursor Size\"\r\n                  value={cursorSize}\r\n                  onChange={setCursorSize}\r\n                  icon={<LucideMousePointer2 className=\"h-4 w-4\" />}\r\n                />\r\n\r\n                <div className=\"p-4 bg-blue-50 rounded-lg space-y-2\">\r\n                  <div className=\"flex items-start gap-2\">\r\n                    <LucideInfo className=\"h-4 w-4 text-blue-500 mt-0.5\" />\r\n                    <div>\r\n                      <h4 className=\"text-sm font-medium\">\r\n                        Keyboard Shortcuts\r\n                      </h4>\r\n                      <ul className=\"text-xs space-y-1 mt-1\">\r\n                        <li>\r\n                          <kbd className=\"bg-gray-200 px-1 py-0.5 rounded text-gray-800\">\r\n                            Ctrl\r\n                          </kbd>{\" \"}\r\n                          +{\" \"}\r\n                          <kbd className=\"bg-gray-200 px-1 py-0.5 rounded text-gray-800\">\r\n                            U\r\n                          </kbd>\r\n                          : Toggle Accessibility Panel\r\n                        </li>\r\n                        <li>\r\n                          <kbd className=\"bg-gray-200 px-1 py-0.5 rounded text-gray-800\">\r\n                            Tab\r\n                          </kbd>\r\n                          : Navigate through elements\r\n                        </li>\r\n                        <li>\r\n                          <kbd className=\"bg-gray-200 px-1 py-0.5 rounded text-gray-800\">\r\n                            Enter\r\n                          </kbd>\r\n                          : Activate focused element\r\n                        </li>\r\n                        <li>\r\n                          <kbd className=\"bg-gray-200 px-1 py-0.5 rounded text-gray-800\">\r\n                            Esc\r\n                          </kbd>\r\n                          : Close dialogs or menus\r\n                        </li>\r\n                      </ul>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </TabsContent>\r\n\r\n              <TabsContent value=\"screen-reader\" className=\"space-y-6\">\r\n                <div className=\"flex items-center justify-between rounded-lg border p-4\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <label\r\n                      htmlFor=\"screen-reader-toggle\"\r\n                      className=\"text-sm font-medium\"\r\n                    >\r\n                      Enable Screen Reader\r\n                    </label>\r\n                    <p className=\"text-muted-foreground text-sm\">\r\n                      Reads content aloud as you hover or focus.\r\n                    </p>\r\n                  </div>\r\n                  <Switch\r\n                    id=\"screen-reader-toggle\"\r\n                    checked={screenReader.enabled}\r\n                    onCheckedChange={toggleScreenReader}\r\n                  />\r\n                </div>\r\n\r\n                {screenReader.enabled && (\r\n                  <>\r\n                    <AccessibilitySlider\r\n                      label=\"Speech Speed\"\r\n                      value={\r\n                        screenReader.speed === \"slow\" ? \"medium\" : \"default\"\r\n                      }\r\n                      onChange={(val) =>\r\n                        setScreenReaderSpeed(\r\n                          val === \"medium\" ? \"slow\" : \"normal\",\r\n                        )\r\n                      }\r\n                      icon={<LucideZap className=\"h-4 w-4\" />}\r\n                      options={[\r\n                        { value: \"default\", label: \"Normal\" },\r\n                        { value: \"medium\", label: \"Slow\" },\r\n                      ]}\r\n                    />\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-5 h-5 flex items-center justify-center\">\r\n                          <LucideVolume2 className=\"h-4 w-4\" />\r\n                        </div>\r\n                        <span className=\"text-sm font-medium\">Volume</span>\r\n                      </div>\r\n                      <Slider\r\n                        min={0}\r\n                        max={1}\r\n                        step={0.1}\r\n                        value={[screenReader.volume]}\r\n                        onValueChange={(val) => setScreenReaderVolume(val[0])}\r\n                        className=\"w-full\"\r\n                      />\r\n                      <p className=\"text-right text-xs text-muted-foreground\">\r\n                        {(screenReader.volume * 100).toFixed(0)}%\r\n                      </p>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </TabsContent>\r\n            </div>\r\n          </Tabs>\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"p-4 border-t bg-background flex-shrink-0 sticky bottom-0\">\r\n          <div className=\"flex justify-between gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={resetAll}\r\n              className=\"flex items-center gap-1\"\r\n            >\r\n              <LucideRefreshCw className=\"h-3.5 w-3.5\" />\r\n              Reset All\r\n            </Button>\r\n            <Button\r\n              variant=\"default\"\r\n              size=\"sm\"\r\n              className=\"flex items-center gap-1\"\r\n              onClick={toggleOpen}\r\n            >\r\n              <LucideX className=\"h-3.5 w-3.5\" />\r\n              Close\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n",
      "type": "registry:ui",
      "target": ""
    },
    {
      "path": "ui/accessibility/lib/accessibility-store.ts",
      "content": "\"use client\";\n\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\n\n// Define types for feature intensity levels\nexport type FeatureIntensity = \"default\" | \"medium\" | \"high\";\nexport type ContrastMode = \"default\" | \"inverted\" | \"dark\" | \"light\"; // New contrast modes\n\ninterface AccessibilityState {\n  isOpen: boolean;\n  toggleOpen: () => void;\n\n  // Accessibility features with intensity levels\n  contrast: ContrastMode; // Changed to ContrastMode\n  setContrast: (level: ContrastMode) => void; // Changed to ContrastMode\n\n  highlightLinks: FeatureIntensity;\n  setHighlightLinks: (level: FeatureIntensity) => void;\n\n  textSize: FeatureIntensity;\n  setTextSize: (level: FeatureIntensity) => void;\n\n  textSpacing: FeatureIntensity;\n  setTextSpacing: (level: FeatureIntensity) => void;\n\n  hideImages: boolean;\n  toggleHideImages: () => void;\n\n  dyslexiaFriendly: boolean;\n  toggleDyslexiaFriendly: () => void;\n\n  lineHeight: FeatureIntensity;\n  setLineHeight: (level: FeatureIntensity) => void;\n\n  saturation: FeatureIntensity;\n  setSaturation: (level: FeatureIntensity) => void;\n\n  // New: Cursor Size\n  cursorSize: FeatureIntensity;\n  setCursorSize: (level: FeatureIntensity) => void;\n\n  // Screen reader\n  screenReader: {\n    enabled: boolean;\n    speed: \"normal\" | \"slow\";\n    volume: number; // 0 to 1\n  };\n  toggleScreenReader: () => void;\n  setScreenReaderSpeed: (speed: \"normal\" | \"slow\") => void;\n  setScreenReaderVolume: (volume: number) => void;\n\n  // Reset function\n  resetAll: () => void;\n}\n\nconst initialState: AccessibilityState = {\n  isOpen: false,\n  toggleOpen: () => {},\n\n  contrast: \"default\",\n  setContrast: () => {},\n\n  highlightLinks: \"default\",\n  setHighlightLinks: () => {},\n\n  textSize: \"default\",\n  setTextSize: () => {},\n\n  textSpacing: \"default\",\n  setTextSpacing: () => {},\n\n  hideImages: false,\n  toggleHideImages: () => {},\n\n  dyslexiaFriendly: false,\n  toggleDyslexiaFriendly: () => {},\n\n  lineHeight: \"default\",\n  setLineHeight: () => {},\n\n  saturation: \"default\",\n  setSaturation: () => {},\n\n  cursorSize: \"default\", // Initialize cursor size\n  setCursorSize: () => {},\n\n  screenReader: {\n    enabled: false,\n    speed: \"normal\",\n    volume: 0.8,\n  },\n  toggleScreenReader: () => {},\n  setScreenReaderSpeed: () => {},\n  setScreenReaderVolume: () => {},\n\n  resetAll: () => {},\n};\n\nexport const useAccessibilityStore = create<AccessibilityState>()(\n  persist(\n    (set, get) => ({\n      ...initialState, // Spread the initial state\n\n      toggleOpen: () => set((state) => ({ isOpen: !state.isOpen })),\n\n      setContrast: (level) => set(() => ({ contrast: level })),\n      setHighlightLinks: (level) => set(() => ({ highlightLinks: level })),\n      setTextSize: (level) => set(() => ({ textSize: level })),\n      setTextSpacing: (level) => set(() => ({ textSpacing: level })),\n      toggleHideImages: () =>\n        set((state) => ({ hideImages: !state.hideImages })),\n      toggleDyslexiaFriendly: () =>\n        set((state) => ({ dyslexiaFriendly: !state.dyslexiaFriendly })),\n      setLineHeight: (level) => set(() => ({ lineHeight: level })),\n      setSaturation: (level) => set(() => ({ saturation: level })),\n\n      // New: Set Cursor Size\n      setCursorSize: (level) => set(() => ({ cursorSize: level })),\n\n      toggleScreenReader: () =>\n        set((state) => ({\n          screenReader: {\n            ...state.screenReader,\n            enabled: !state.screenReader.enabled,\n          },\n        })),\n      setScreenReaderSpeed: (speed) =>\n        set((state) => ({\n          screenReader: {\n            ...state.screenReader,\n            speed,\n          },\n        })),\n      setScreenReaderVolume: (volume) =>\n        set((state) => ({\n          screenReader: {\n            ...state.screenReader,\n            volume,\n          },\n        })),\n\n      resetAll: () => {\n        // Reset to initial values (excluding isOpen, as that's managed by toggleOpen)\n        set({\n          contrast: \"default\",\n          highlightLinks: \"default\",\n          textSize: \"default\",\n          textSpacing: \"default\",\n          hideImages: false,\n          dyslexiaFriendly: false,\n          lineHeight: \"default\",\n          saturation: \"default\",\n          cursorSize: \"default\",\n          screenReader: {\n            enabled: false,\n            speed: \"normal\",\n            volume: 0.8,\n          },\n        });\n      },\n    }),\n    {\n      name: \"accessibility-storage\", // unique name\n      getStorage: () => localStorage,\n    },\n  ),\n);\n",
      "type": "registry:lib",
      "target": ""
    },
    {
      "path": "ui/accessibility/lib/screen-reader-service.ts",
      "content": "\"use client\";\n\nclass ScreenReaderService {\n  private speechSynthesis: SpeechSynthesis | null = null;\n  private utterance: SpeechSynthesisUtterance | null = null;\n  private isReading: boolean = false;\n  private isMounted: boolean = false;\n  private currentElement: HTMLElement | null = null;\n  private lastElementSelector: string = \"\";\n  private highlightClass = \"screen-reader-highlight\";\n\n  constructor() {\n    this.isMounted = typeof window !== \"undefined\";\n\n    if (this.isMounted) {\n      try {\n        this.speechSynthesis = window.speechSynthesis;\n        this.utterance = new SpeechSynthesisUtterance();\n\n        if (this.speechSynthesis) {\n          this.speechSynthesis.cancel();\n        }\n      } catch (error) {\n        console.error(\"Error initializing speech synthesis:\", error);\n        this.isMounted = false;\n      }\n    }\n  }\n\n  public cleanup() {\n    if (!this.isMounted) return;\n\n    document.removeEventListener(\"mouseover\", this.handleHover);\n    document.removeEventListener(\"focusin\", this.handleFocus);\n    this.stop();\n  }\n\n  // Store bound handlers to ensure proper removal\n  private handleHover = this.createHandleEvent(\"mouseover\");\n  private handleFocus = this.createHandleEvent(\"focusin\");\n\n  public initialize(\n    enabled: boolean,\n    speed: \"normal\" | \"slow\",\n    volume: number,\n  ) {\n    if (!this.isMounted) return;\n\n    // Set speech properties\n    this.utterance!.rate = speed === \"slow\" ? 0.8 : 1.0;\n    this.utterance!.volume = volume;\n\n    if (enabled) {\n      document.addEventListener(\"mouseover\", this.handleHover);\n      document.addEventListener(\"focusin\", this.handleFocus);\n    } else {\n      document.removeEventListener(\"mouseover\", this.handleHover);\n      document.removeEventListener(\"focusin\", this.handleFocus);\n      this.stop(); // Stop reading if disabled\n    }\n  }\n\n  private createHandleEvent(eventType: \"mouseover\" | \"focusin\") {\n    return (event: Event) => {\n      const target = event.target as HTMLElement;\n\n      // Avoid re-reading the same element if already highlighted and reading\n      if (\n        this.currentElement === target ||\n        !this.isSignificantElement(target)\n      ) {\n        return;\n      }\n\n      const selector = this.getElementSelector(target);\n\n      // Prevent reading the same element repeatedly, or if it's the accessibility trigger itself\n      if (\n        selector === this.lastElementSelector ||\n        target.closest(\".accessibility-trigger\") ||\n        target.closest(\".accessibility-panel-container\")\n      ) {\n        return;\n      }\n\n      this.stop(); // Stop current speech before starting new one\n      this.removeHighlight();\n\n      this.currentElement = target;\n      this.lastElementSelector = selector;\n\n      const text = this.getTextForElement(target);\n      if (text) {\n        this.speak(text);\n        this.addHighlight(target);\n      }\n    };\n  }\n\n  private speak(text: string) {\n    if (!this.speechSynthesis || !this.utterance) return;\n\n    this.utterance.text = text;\n    this.speechSynthesis.speak(this.utterance);\n    this.isReading = true;\n\n    this.utterance.onend = () => {\n      this.isReading = false;\n      this.removeHighlight();\n      this.currentElement = null;\n      this.lastElementSelector = \"\"; // Reset after speech ends\n    };\n\n    this.utterance.onerror = (event) => {\n      console.error(\"SpeechSynthesisUtterance.onerror\", event);\n      this.isReading = false;\n      this.removeHighlight();\n      this.currentElement = null;\n      this.lastElementSelector = \"\";\n    };\n  }\n\n  public stop() {\n    if (this.speechSynthesis && this.isReading) {\n      this.speechSynthesis.cancel();\n      this.isReading = false;\n    }\n    this.removeHighlight();\n    this.currentElement = null;\n    this.lastElementSelector = \"\";\n  }\n\n  private addHighlight(element: HTMLElement) {\n    element.classList.add(this.highlightClass);\n  }\n\n  private removeHighlight() {\n    document\n      .querySelectorAll(`.${this.highlightClass}`)\n      .forEach((el) => el.classList.remove(this.highlightClass));\n  }\n\n  private getTextForElement(element: HTMLElement): string {\n    // Check for explicit accessibility labels first\n    if (element.getAttribute(\"aria-label\")) {\n      return element.getAttribute(\"aria-label\")!;\n    }\n    if (element.getAttribute(\"title\")) {\n      return element.getAttribute(\"title\")!;\n    }\n\n    // Get text based on element type and role\n    if (element.tagName === \"IMG\") {\n      return element.alt || \"Image\";\n    }\n\n    if (element.tagName === \"A\") {\n      return `Link: ${element.textContent || \"\"}`;\n    }\n\n    if (element.tagName === \"BUTTON\") {\n      return `Button: ${element.textContent || \"\"}`;\n    }\n\n    if (element.tagName === \"INPUT\") {\n      const inputEl = element as HTMLInputElement;\n      const type = inputEl.type;\n      const label =\n        inputEl.placeholder || inputEl.name || inputEl.id || \"Input field\";\n      if (type === \"text\") return `Text input: ${label}`;\n      if (type === \"email\") return `Email input: ${label}`;\n      if (type === \"password\") return `Password input: ${label}`;\n      if (type === \"checkbox\")\n        return `Checkbox: ${label} ${inputEl.checked ? \"checked\" : \"unchecked\"}`;\n      if (type === \"radio\")\n        return `Radio button: ${label} ${inputEl.checked ? \"selected\" : \"\"}`;\n      if (type === \"submit\") return `Submit button: ${inputEl.value || label}`;\n      return `${label}`;\n    }\n\n    if (element.tagName === \"SELECT\") {\n      const selectEl = element as HTMLSelectElement;\n      const label = selectEl.name || selectEl.id || \"Select field\";\n      const selectedOption = selectEl.options[selectEl.selectedIndex];\n      return `Dropdown: ${label}, current value ${selectedOption ? selectedOption.textContent : \"\"}`;\n    }\n\n    if (element.tagName === \"TEXTAREA\") {\n      const textareaEl = element as HTMLTextAreaElement;\n      const label = textareaEl.name || textareaEl.id || \"Text area\";\n      return `Text area: ${label}`;\n    }\n\n    if (element.hasAttribute(\"role\")) {\n      const role = element.getAttribute(\"role\");\n      const textContent = element.textContent || \"\";\n      switch (role) {\n        case \"button\":\n          return `Button: ${textContent}`;\n        case \"link\":\n          return `Link: ${textContent}`;\n        case \"heading\":\n          return `Heading: ${textContent}`;\n        case \"listitem\":\n          return `List item: ${textContent}`;\n        case \"checkbox\":\n          return `Checkbox: ${textContent} ${element.getAttribute(\"aria-checked\") === \"true\" ? \"checked\" : \"unchecked\"}`;\n        case \"radio\":\n          return `Radio button: ${textContent} ${element.getAttribute(\"aria-checked\") === \"true\" ? \"selected\" : \"\"}`;\n        case \"textbox\":\n          return `Text box: ${textContent}`;\n        case \"combobox\":\n          return `Combobox: ${textContent}`;\n        case \"dialog\":\n          return `Dialog: ${textContent}`;\n        case \"alert\":\n          return `Alert: ${textContent}`;\n        case \"status\":\n          return `Status: ${textContent}`;\n        default:\n          return `${role}: ${textContent}`;\n      }\n    }\n\n    // Default to regular text content\n    return element.textContent || \"\";\n  }\n\n  private isSignificantElement(element: HTMLElement): boolean {\n    const significantTags = [\n      \"A\",\n      \"BUTTON\",\n      \"H1\",\n      \"H2\",\n      \"H3\",\n      \"H4\",\n      \"H5\",\n      \"H6\",\n      \"P\",\n      \"LI\",\n      \"IMG\",\n      \"INPUT\", // Added for inputs\n      \"SELECT\", // Added for selects\n      \"TEXTAREA\", // Added for textareas\n      \"LABEL\", // Labels for form elements\n      \"SUMMARY\", // For details/summary elements\n      \"ARTICLE\", // Article content\n      \"SECTION\", // Section content\n      \"ASIDE\", // Aside content\n      \"MAIN\", // Main content\n      \"NAV\", // Navigation elements\n      \"FOOTER\", // Footer content\n      \"HEADER\", // Header content\n    ];\n    return (\n      significantTags.includes(element.tagName) ||\n      element.hasAttribute(\"role\") ||\n      element.hasAttribute(\"aria-label\") ||\n      element.hasAttribute(\"title\")\n    );\n  }\n\n  private getElementSelector(element: HTMLElement): string {\n    // Create a simple selector path for the element\n    const id = element.id ? `#${element.id}` : \"\";\n    const classes = Array.from(element.classList)\n      .map((cls) => `.${cls}`)\n      .join(\"\");\n    return `${element.tagName}${id}${classes}`;\n  }\n}\n\n// Export a singleton instance\nconst screenReaderService = new ScreenReaderService();\nexport default screenReaderService;\n",
      "type": "registry:lib",
      "target": ""
    }
  ]
}